-- Silent Aim without Metatable Hooking (Educational Only)
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local Camera = workspace.CurrentCamera

local function GetClosestPlayer()
    local MaxDistance = math.huge
    local Target = nil
    
    for _, Player in pairs(Players:GetPlayers()) do
        if Player ~= LocalPlayer and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            local RootPart = Player.Character.HumanoidRootPart
            local ScreenPos, OnScreen = Camera:WorldToScreenPoint(RootPart.Position)
            
            if OnScreen then
                local Distance = (Vector2.new(ScreenPos.X, ScreenPos.Y) - Vector2.new(Mouse.X, Mouse.Y)).Magnitude
                if Distance < MaxDistance then
                    MaxDistance = Distance
                    Target = Player
                end
            end
        end
    end
    
    return Target
end

-- Override the mouse's Hit/Target for silent aim
local OldTarget = Mouse.Target
local OldHit = Mouse.Hit

Mouse.TargetFilter = workspace -- Avoid hitting walls

Mouse.Target = function()
    local Target = GetClosestPlayer()
    if Target and Target.Character and Target.Character:FindFirstChild("Head") then
        return Target.Character.Head
    end
    return OldTarget()
end

Mouse.Hit = function()
    local Target = GetClosestPlayer()
    if Target and Target.Character and Target.Character:FindFirstChild("Head") then
        return CFrame.new(Camera.CFrame.Position, Target.Character.Head.Position)
    end
    return OldHit()
end
